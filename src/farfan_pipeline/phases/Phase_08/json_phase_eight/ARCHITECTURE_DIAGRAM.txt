================================================================================
DIMENSIONAL RECOMMENDATIONS CATALOG - ARCHITECTURE DIAGRAM
================================================================================

┌─────────────────────────────────────────────────────────────────────────────┐
│                    DIMENSIONAL-FIRST ARCHITECTURE                           │
└─────────────────────────────────────────────────────────────────────────────┘

┌───────────────────────────────────────────────────────────────────────────┐
│ LAYER 1: DIMENSIONAL TEMPLATES (Universal Logic)                         │
│ Storage: 30 templates (6 dimensions × 5 bands)                           │
└───────────────────────────────────────────────────────────────────────────┘

    DIM01: Insumos                DIM02: Productos              DIM06: Causalidad
    ┌───────────────────┐         ┌───────────────────┐         ┌───────────────────┐
    │ CRISIS            │         │ CRISIS            │   ...   │ EXCELENTE         │
    │ ├─ Logic          │         │ ├─ Logic          │         │ ├─ Logic          │
    │ ├─ Activities     │         │ ├─ Activities     │         │ ├─ Activities     │
    │ ├─ Products       │         │ ├─ Products       │         │ ├─ Products       │
    │ ├─ Indicators     │         │ ├─ Indicators     │         │ ├─ Indicators     │
    │ └─ Variables      │         │ └─ Variables      │         │ └─ Variables      │
    ├───────────────────┤         ├───────────────────┤         ├───────────────────┤
    │ CRÍTICO           │         │ CRÍTICO           │         │ BUENO             │
    ├───────────────────┤         ├───────────────────┤         ├───────────────────┤
    │ ACEPTABLE         │         │ ACEPTABLE         │         │ ACEPTABLE         │
    ├───────────────────┤         ├───────────────────┤         ├───────────────────┤
    │ BUENO             │         │ BUENO             │         │ CRÍTICO           │
    ├───────────────────┤         ├───────────────────┤         ├───────────────────┤
    │ EXCELENTE         │         │ EXCELENTE         │         │ CRISIS            │
    └───────────────────┘         └───────────────────┘         └───────────────────┘

                                        ↓
                          ╔═══════════════════════════╗
                          ║   INSTANTIATION ENGINE    ║
                          ║   (Variable Substitution) ║
                          ╚═══════════════════════════╝
                                        ↓

┌───────────────────────────────────────────────────────────────────────────┐
│ LAYER 2: PA INSTANTIATION MAPPINGS (Specific Context)                    │
│ Storage: 10 PA mappings (42 variables each)                              │
└───────────────────────────────────────────────────────────────────────────┘

    PA01: Mujeres           PA02: Seguridad         ...    PA10: Migración
    ┌─────────────────┐     ┌─────────────────┐            ┌─────────────────┐
    │ Legal: Ley 1257 │     │ Legal: Ley 1801 │            │ Legal: Ley 2136 │
    │ Entity: Sec Muj │     │ Entity: Sec Gob │            │ Entity: Ger Mig │
    │ System: Trazador│     │ System: SISBEN  │            │ System: RAMV    │
    │ [42 variables]  │     │ [42 variables]  │            │ [42 variables]  │
    └─────────────────┘     └─────────────────┘            └─────────────────┘

                                        ↓

┌───────────────────────────────────────────────────────────────────────────┐
│ OUTPUT: INSTANTIATED RECOMMENDATIONS (Contextualized)                     │
│ Generation: 300 rules (10 PAs × 6 DIMs × 5 bands)                        │
└───────────────────────────────────────────────────────────────────────────┘

    PA01-DIM01-CRISIS                     PA02-DIM01-CRISIS
    ┌─────────────────────────────┐      ┌─────────────────────────────┐
    │ Intervention: [UNIVERSAL]   │      │ Intervention: [UNIVERSAL]   │
    │   "Realizar barrido..."     │      │   "Realizar barrido..."     │
    │                             │      │                             │
    │ Legal: Ley 1257 [PA01]      │      │ Legal: Ley 1801 [PA02]      │
    │ Entity: Sec Mujer [PA01]    │      │ Entity: Sec Gobierno [PA02] │
    │ System: Trazador [PA01]     │      │ System: SISBEN [PA02]       │
    │                             │      │                             │
    │ Activities: [UNIVERSAL]     │      │ Activities: [UNIVERSAL]     │
    │ Products: [UNIVERSAL]       │      │ Products: [UNIVERSAL]       │
    │ Indicators: [UNIVERSAL]     │      │ Indicators: [UNIVERSAL]     │
    └─────────────────────────────┘      └─────────────────────────────┘

================================================================================
KEY ARCHITECTURAL BENEFITS
================================================================================

1. REDUNDANCY ELIMINATION
   ┌────────────────────────────────────────────────────────────┐
   │ Before: 300 rules with 90% duplication                    │
   │ After:  30 templates + 10 mappings = 40 unique components │
   │ Saved:  270 redundant rules eliminated                    │
   └────────────────────────────────────────────────────────────┘

2. SINGLE SOURCE OF TRUTH
   ┌────────────────────────────────────────────────────────────┐
   │ Update once:  DIM01-CRISIS intervention logic             │
   │ Applies to:   All 10 PAs automatically                    │
   │ Consistency:  Guaranteed (no manual synchronization)      │
   └────────────────────────────────────────────────────────────┘

3. EXTENSIBILITY
   ┌────────────────────────────────────────────────────────────┐
   │ Add PA11:     Only create instantiation mapping           │
   │ Effort:       42 variables vs. 30 full rules              │
   │ Result:       30 new recommendations instantly available  │
   └────────────────────────────────────────────────────────────┘

4. TRACEABILITY
   ┌────────────────────────────────────────────────────────────┐
   │ DIM01 → Q001-Q005 → SemanticProcessor.chunk_text         │
   │ DIM02 → Q006-Q010 → PDETMunicipalPlanAnalyzer            │
   │ ...                                                        │
   │ DIM06 → Q026-Q030 → CausalExtractor.extract_causal       │
   └────────────────────────────────────────────────────────────┘

================================================================================
DATA FLOW
================================================================================

┌──────────────┐     ┌─────────────────┐     ┌──────────────────┐
│  User Query  │ --> │ Score: 0.5      │ --> │ Band: CRISIS     │
│ PA01 + DIM01 │     │ PA: PA01        │     │ DIM: DIM01       │
└──────────────┘     │ DIM: DIM01      │     └──────────────────┘
                     └─────────────────┘              │
                                                      ↓
                     ┌─────────────────────────────────────────┐
                     │ 1. Get dimensional template:            │
                     │    dimensions['DIM01']['CRISIS']        │
                     │                                         │
                     │ 2. Get PA context:                      │
                     │    instantiation_mappings['PA01']       │
                     │                                         │
                     │ 3. Extract variables:                   │
                     │    - legal_framework_key                │
                     │    - responsible_entity_key             │
                     │    - reporting_system_key               │
                     │                                         │
                     │ 4. Substitute:                          │
                     │    template + context → recommendation  │
                     └─────────────────────────────────────────┘
                                      │
                                      ↓
                     ┌─────────────────────────────────────────┐
                     │ OUTPUT: PA01-DIM01-CRISIS              │
                     │ - Intervention: [from template]         │
                     │ - Legal: Ley 1257 [from PA01]          │
                     │ - Entity: Sec Mujer [from PA01]        │
                     │ - System: Trazador [from PA01]         │
                     │ - Activities: [from template]           │
                     │ - Products: [from template]             │
                     │ - Indicators: [from template]           │
                     └─────────────────────────────────────────┘

================================================================================
COMPARISON: PA-ANCHORED vs DIMENSIONAL-FIRST
================================================================================

PA-ANCHORED (Before)                  DIMENSIONAL-FIRST (After)
┌──────────────────────────────┐      ┌──────────────────────────────┐
│ PA01-DIM01-CRISIS            │      │ DIM01-CRISIS [template]      │
│   ├─ Full logic              │      │   ├─ Core logic              │
│   ├─ Legal: Ley 1257         │      │   ├─ Variables:              │
│   └─ Entity: Sec Mujer       │      │   │   - legal_framework_key  │
├──────────────────────────────┤      │   │   - entity_key           │
│ PA02-DIM01-CRISIS            │      │   └─ - system_key           │
│   ├─ [DUPLICATE LOGIC]       │  +   ├──────────────────────────────┤
│   ├─ Legal: Ley 1801         │      │ PA01 [mapping]               │
│   └─ Entity: Sec Gobierno    │      │   ├─ Legal: Ley 1257        │
├──────────────────────────────┤      │   └─ Entity: Sec Mujer       │
│ PA03-DIM01-CRISIS            │      ├──────────────────────────────┤
│   ├─ [DUPLICATE LOGIC]       │      │ PA02 [mapping]               │
│   ├─ Legal: Ley 99           │      │   ├─ Legal: Ley 1801        │
│   └─ Entity: Sec Ambiente    │      │   └─ Entity: Sec Gobierno    │
├──────────────────────────────┤      └──────────────────────────────┘
│ ... [7 more duplicates]      │              ↓ Instantiation
└──────────────────────────────┘      ┌──────────────────────────────┐
                                      │ Generate all 10 PA versions  │
300 rules = 270 duplicates            │ on-demand from 1 template    │
                                      └──────────────────────────────┘

                                      30 templates + 10 mappings = 
                                      same 300 rules, zero redundancy

================================================================================
CREATED: 2026-01-26 | VERSION: 1.0.0 | STATUS: PRODUCTION READY
================================================================================
