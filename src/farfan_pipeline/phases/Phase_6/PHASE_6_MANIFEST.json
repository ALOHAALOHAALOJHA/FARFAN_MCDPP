{
  "$schema": "../../schemas/phase_manifest_schema.json",
  "manifest_version": "3.0.0",
  "phase": {
    "number": 6,
    "name": "Cluster Aggregation (MESO)",
    "codename": "CLUSTER",
    "label": "Phase 6",
    "version": "3.0.0",
    "status": "PRODUCTION",
    "criticality": "HIGH"
  },
  "metadata": {
    "created": "2025-01-09T00:00:00Z",
    "modified": "2026-01-16T00:00:00Z",
    "authors": ["F.A.R.F.A.N Core Team"],
    "owners": ["phase6_team"],
    "repository": "FARFAN_MCDPP"
  },
  "description": "Phase 6 aggregates 10 Policy Area scores into 4 MESO-level Cluster scores with adaptive penalty based on dispersion analysis. Implements strict topological order with zero circular dependencies.",
  "stages": [
    {
      "code": 10,
      "name": "Foundation & Data Models",
      "description": "Constants, cluster composition, and ClusterScore data model",
      "execution_order": 1
    },
    {
      "code": 20,
      "name": "Adaptive Penalty Mechanism",
      "description": "Dispersion analysis and adaptive penalty computation",
      "execution_order": 2
    },
    {
      "code": 30,
      "name": "Cluster Aggregation",
      "description": "Main orchestrator - 10 AreaScores to 4 ClusterScores",
      "execution_order": 3
    },
    {
      "code": 40,
      "name": "Contract Validation",
      "description": "Input/output validation and Phase 7 compatibility",
      "execution_order": 4
    }
  ],
  "contracts": {
    "input": "10 AreaScore objects (PA01-PA10)",
    "output": "4 ClusterScore objects (CLUSTER_MESO_1 to CLUSTER_MESO_4)",
    "invariants": [
      "len(output) == 4",
      "all scores in [0.0, 3.0]",
      "all penalty_factors in [0.7, 1.0]",
      "dispersion metrics computed",
      "coherence metrics computed",
      "zero circular dependencies",
      "zero orphan files"
    ]
  },
  "quality_metrics": {
    "coverage": 0.95,
    "complexity": "HIGH",
    "dag_validated": true,
    "orphan_files": 0,
    "circular_dependencies": 0
  },
  "performance_characteristics": {
    "time_complexity": "O(n) where n=10 areas",
    "space_complexity": "O(n)",
    "aggregation_time_ms": "<5"
  },
  "changelog": {
    "3.0.0": {
      "date": "2026-01-16",
      "changes": [
        "Created unified scoring config (phase6_10_01_scoring_config.py)",
        "Wired contracts into ClusterAggregator.aggregate()",
        "Added configurable contract enforcement (strict/warn/disabled)",
        "Integrated coherence quality classification into output contract",
        "Updated all documentation to reflect implemented state",
        "Resolved all 5 audit findings from technical specification"
      ]
    },
    "2.0.0": {
      "date": "2026-01-13",
      "changes": [
        "Implemented ClusterAggregator (390 lines)",
        "Created contracts (input, output, mission)",
        "Migrated adaptive_meso_scoring from Phase 4"
      ]
    },
    "1.0.0": {
      "date": "2025-01-09",
      "changes": [
        "Initial Phase 6 structure",
        "Constants defined"
      ]
    }
  },
  "modules": {
    "stage_10": [
      {
        "file": "phase6_10_00_phase_6_constants.py",
        "purpose": "Cluster composition and re-exports from unified config",
        "exports": ["CLUSTERS", "CLUSTER_COMPOSITION", "PENALTY_WEIGHT", "DISPERSION_THRESHOLDS"]
      },
      {
        "file": "phase6_10_01_scoring_config.py",
        "purpose": "Single source of truth for all scoring parameters",
        "exports": ["PHASE6_CONFIG", "Phase6ScoringConfig", "DispersionScenario", "CoherenceQuality"]
      },
      {
        "file": "phase6_10_00_cluster_score.py",
        "purpose": "ClusterScore dataclass definition",
        "exports": ["ClusterScore"]
      }
    ],
    "stage_20": [
      {
        "file": "phase6_20_00_adaptive_meso_scoring.py",
        "purpose": "Adaptive penalty calculation based on dispersion",
        "exports": ["AdaptiveMesoScoring", "AdaptiveScoringConfig", "ScoringMetrics"]
      }
    ],
    "stage_30": [
      {
        "file": "phase6_30_00_cluster_aggregator.py",
        "purpose": "Main aggregation orchestrator with contract enforcement",
        "exports": ["ClusterAggregator"]
      }
    ],
    "stage_40": [
      {
        "file": "contracts/phase6_input_contract.py",
        "purpose": "Precondition validation for 10 AreaScores",
        "exports": ["Phase6InputContract"]
      },
      {
        "file": "contracts/phase6_mission_contract.py",
        "purpose": "Invariants I1-I6 and mission statement",
        "exports": ["Phase6MissionContract", "MISSION_STATEMENT"]
      },
      {
        "file": "contracts/phase6_output_contract.py",
        "purpose": "Postcondition validation and compatibility certificate",
        "exports": ["Phase6OutputContract", "validate_phase6_output"]
      }
    ]
  },
  "validation": {
    "compliant": true,
    "last_check": "2026-01-16T00:00:00Z",
    "topological_order_validated": true,
    "contracts_validated": true
  }
}
