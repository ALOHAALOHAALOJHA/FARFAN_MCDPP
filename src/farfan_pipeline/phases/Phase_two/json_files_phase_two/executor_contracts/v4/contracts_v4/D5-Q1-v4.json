{
  "identity": {
    "base_slot": "D5-Q1",
    "representative_question_id": "Q021",
    "dimension_id": "DIM05",
    "policy_area_ids_served": [
      "PA01",
      "PA02",
      "PA03",
      "PA04",
      "PA05",
      "PA06",
      "PA07",
      "PA08",
      "PA09",
      "PA10"
    ],
    "contracts_served": [
      "Q021",
      "Q051",
      "Q081",
      "Q111",
      "Q141",
      "Q171",
      "Q201",
      "Q231",
      "Q261",
      "Q291"
    ],
    "contract_type": "TYPE_D",
    "contract_type_name": "Financiero",
    "contract_type_focus": "Suficiencia presupuestal, coherencia costo-meta",
    "contract_version": "4.1.0-corrected",
    "created_at": "2025-12-23T15:55:00Z",
    "specification_source": "episte_refact.md (PARTE IV, TYPE_D)"
  },
  "executor_binding": {
    "executor_class": "D5_Q1_Executor",
    "executor_module": "farfan_pipeline.phases.Phase_two.executors"
  },
  "method_binding": {
    "orchestration_mode": "epistemological_pipeline",
    "contract_type": "TYPE_D",
    "method_count": 3,
    "execution_phases": {
      "phase_A_construction": {
        "description": "Empirical observation layer - extraction of financial data",
        "level": "N1",
        "level_name": "Base Emp√≠rica Financiera",
        "epistemology": "Empirismo positivista",
        "methods": [
          {
            "class_name": "PDETMunicipalPlanAnalyzer",
            "method_name": "_extract_financial_amounts",
            "mother_file": "financiero_viabilidad_tablas.py",
            "provides": "pdetmunicipalplananalyzer.extract_financial_amounts",
            "level": "N1-EMP",
            "output_type": "FACT",
            "fusion_behavior": "additive",
            "description": "Extrae montos financieros expl√≠citos de tablas y texto",
            "requires": [],
            "classification_rationale": "Extracci√≥n literal de datos num√©ricos ‚Üí N1-EMP"
          }
        ],
        "dependencies": [],
        "output_target": "financial_facts"
      },
      "phase_B_computation": {
        "description": "Inferential analysis layer - calculation of sufficiency metrics",
        "level": "N2",
        "level_name": "C√°lculo de Suficiencia",
        "epistemology": "Formalismo contable",
        "methods": [
          {
            "class_name": "FinancialAuditor",
            "method_name": "_calculate_sufficiency_score",
            "mother_file": "financiero_viabilidad_tablas.py",
            "provides": "financialauditor.calculate_sufficiency_score",
            "level": "N2-INF",
            "output_type": "PARAMETER",
            "fusion_behavior": "multiplicative",
            "description": "Calcula score de suficiencia presupuestal vs metas",
            "requires": [
              "financial_facts"
            ],
            "modifies": [
              "edge_weights",
              "confidence_scores"
            ],
            "classification_rationale": "C√°lculo derivado (ratio) ‚Üí N2-INF"
          }
        ],
        "dependencies": [
          "phase_A_construction"
        ],
        "output_target": "sufficiency_scores"
      },
      "phase_C_litigation": {
        "description": "Audit layer - financial coherence validation",
        "level": "N3",
        "level_name": "Auditor√≠a Financiera",
        "epistemology": "Auditor√≠a Forense",
        "asymmetry_principle": "N3 can invalidate N1/N2 findings, but N1/N2 CANNOT invalidate N3",
        "methods": [
          {
            "class_name": "FinancialAuditor",
            "method_name": "_detect_allocation_gaps",
            "mother_file": "financiero_viabilidad_tablas.py",
            "provides": "financialauditor.detect_allocation_gaps",
            "level": "N3-AUD",
            "output_type": "CONSTRAINT",
            "fusion_behavior": "gate",
            "description": "Detecta brechas de asignaci√≥n que invalidan la viabilidad",
            "requires": [
              "financial_facts",
              "sufficiency_scores"
            ],
            "modulates": [
              "financial_facts.confidence",
              "sufficiency_scores.confidence"
            ],
            "veto_conditions": {
              "budget_gap_critical": {
                "trigger": "gap > 50%",
                "action": "block_branch",
                "scope": "affected_goals",
                "confidence_multiplier": 0.0
              },
              "allocation_mismatch": {
                "trigger": "mismatch_detected",
                "action": "reduce_confidence",
                "scope": "source_facts",
                "confidence_multiplier": 0.5
              }
            }
          }
        ],
        "dependencies": [
          "phase_A_construction",
          "phase_B_computation"
        ],
        "output_target": "audit_results",
        "fusion_mode": "modulation"
      }
    }
  },
  "question_context": {
    "monolith_ref": "Q021",
    "overrides": null,
    "failure_contract": {
      "abort_if": [
        "missing_required_element",
        "no_quantitative_data"
      ],
      "emit_code": "ABORT-D5-Q1-REQ"
    }
  },
  "signal_requirements": {
    "derivation_source": "expected_elements",
    "derivation_rules": {
      "mandatory": "expected_elements[required=true].type ‚Üí detection_{type}",
      "optional": "expected_elements[required=false].type ‚Üí detection_{type}"
    },
    "signal_aggregation": "weighted_mean",
    "minimum_signal_threshold": 0.5
  },
  "evidence_assembly": {
    "engine": "EVIDENCE_NEXUS",
    "module": "farfan_pipeline.phases.Phase_two.evidence_nexus",
    "class_name": "EvidenceNexus",
    "method_name": "assemble",
    "type_system": {
      "FACT": {
        "origin_level": "N1",
        "fusion_operation": "graph_node_addition",
        "merge_behavior": "additive",
        "symbol": "‚äï"
      },
      "PARAMETER": {
        "origin_level": "N2",
        "fusion_operation": "edge_weight_modification",
        "merge_behavior": "multiplicative",
        "symbol": "‚äó"
      },
      "CONSTRAINT": {
        "origin_level": "N3",
        "fusion_operation": "branch_filtering",
        "merge_behavior": "gate",
        "symbol": "‚äò"
      },
      "NARRATIVE": {
        "origin_level": "N4",
        "fusion_operation": "synthesis",
        "merge_behavior": "terminal",
        "symbol": "‚äô"
      }
    },
    "assembly_rules": [
      {
        "rule_id": "R1_financial_extraction",
        "rule_type": "empirical_basis",
        "target": "financial_facts",
        "sources": [
          "pdetmunicipalplananalyzer.extract_financial_amounts"
        ],
        "merge_strategy": "concat",
        "output_type": "FACT",
        "confidence_propagation": "preserve_individual"
      },
      {
        "rule_id": "R2_sufficiency_analysis",
        "rule_type": "computation",
        "target": "sufficiency_scores",
        "sources": [
          "financialauditor.calculate_sufficiency_score"
        ],
        "input_dependencies": [
          "financial_facts"
        ],
        "merge_strategy": "weighted_mean",
        "output_type": "PARAMETER",
        "confidence_propagation": "weighted_average"
      },
      {
        "rule_id": "R3_coherence_audit",
        "rule_type": "financial_coherence_audit",
        "target": "validated_financials",
        "sources": [
          "financialauditor.detect_allocation_gaps"
        ],
        "input_dependencies": [
          "financial_facts",
          "sufficiency_scores"
        ],
        "merge_strategy": "veto_gate",
        "gate_logic": {
          "budget_gap_detected": {
            "action": "flag_insufficiency",
            "multiplier": 0.3
          },
          "allocation_mismatch": {
            "action": "reduce_confidence",
            "multiplier": 0.5
          }
        },
        "output_type": "CONSTRAINT"
      },
      {
        "rule_id": "R4_synthesis",
        "rule_type": "synthesis",
        "target": "human_answer",
        "sources": [],
        "input_dependencies": [
          "validated_financials"
        ],
        "merge_strategy": "carver_doctoral_synthesis",
        "output_type": "NARRATIVE",
        "external_handler": {
          "class": "DoctoralCarverSynthesizer",
          "module": "farfan_pipeline.phases.Phase_two.carver"
        }
      }
    ]
  },
  "fusion_specification": {
    "contract_type": "TYPE_D",
    "primary_strategy": "financial_coherence_audit",
    "level_strategies": {
      "N1_fact_fusion": {
        "strategy": "concat",
        "behavior": "additive",
        "conflict_resolution": "preserve_all"
      },
      "N2_parameter_fusion": {
        "strategy": "weighted_mean",
        "behavior": "multiplicative",
        "conflict_resolution": "weighted_voting",
        "affects": [
          "N1_facts.confidence"
        ]
      },
      "N3_constraint_fusion": {
        "strategy": "veto_gate",
        "behavior": "gate",
        "asymmetry_principle": "audit_dominates",
        "propagation": {
          "upstream": "confidence_backpropagation",
          "downstream": "branch_blocking"
        }
      }
    },
    "fusion_pipeline": {
      "stage_1_fact_accumulation": {
        "input": "phase_A_construction.outputs",
        "operation": "EXTRACT financial data points",
        "output": "financial_graph_v1",
        "type_consumed": "FACT",
        "behavior": "additive"
      },
      "stage_2_parameter_application": {
        "input": [
          "financial_graph_v1",
          "phase_B_computation.outputs"
        ],
        "operation": "CALCULATE sufficiency scores",
        "output": "financial_graph_v2_scored",
        "type_consumed": "PARAMETER",
        "behavior": "multiplicative"
      },
      "stage_3_constraint_filtering": {
        "input": [
          "financial_graph_v2_scored",
          "phase_C_litigation.outputs"
        ],
        "operation": "AUDIT for allocation gaps",
        "output": "financial_graph_v3_validated",
        "type_consumed": "CONSTRAINT",
        "behavior": "gate"
      },
      "stage_4_synthesis": {
        "input": "financial_graph_v3_validated",
        "operation": "REPORT financial viability",
        "output": "human_answer",
        "type_produced": "NARRATIVE",
        "behavior": "terminal"
      }
    }
  },
  "cross_layer_fusion": {
    "N1_to_N2": {
      "relationship": "N2 reads N1 financial facts",
      "effect": "N2 calculates ratios from N1 amounts",
      "data_flow": "forward_propagation"
    },
    "N2_to_N1": {
      "relationship": "N2 scores validation confidence",
      "effect": "Sufficiency scores weight fact confidence",
      "data_flow": "confidence_backpropagation"
    },
    "N3_to_N1": {
      "relationship": "N3 audits N1 facts",
      "effect": "Allocation gaps invalidate specific amounts",
      "data_flow": "veto_propagation",
      "asymmetry": "N1 CANNOT invalidate N3"
    },
    "N3_to_N2": {
      "relationship": "N3 can INVALIDATE N2 parameters",
      "effect": "Failed constraints nullify parameter modifications",
      "data_flow": "inference_modulation",
      "asymmetry": "N2 CANNOT invalidate N3"
    },
    "all_to_N4": {
      "relationship": "N4 consumes validated outputs from all layers",
      "effect": "Synthesis constructs narrative from filtered graph",
      "data_flow": "terminal_aggregation"
    },
    "blocking_propagation_rules": {
      "budget_gap_detected": {
        "triggered_by": "FinancialAuditor",
        "action": "block_branch",
        "scope": "affected_goals",
        "propagation": "downstream_only"
      }
    }
  },
  "human_answer_structure": {
    "format": "markdown",
    "template_mode": "epistemological_narrative",
    "contract_type": "TYPE_D",
    "sections": [
      {
        "section_id": "S1_verdict",
        "title": "### Veredicto Financiero",
        "layer": "N4",
        "layer_name": "S√≠ntesis",
        "data_source": "synthesis_output",
        "narrative_style": "declarative",
        "template": {
          "structure": [
            "**Viabilidad**: {verdict_statement}",
            "",
            "**Suficiencia Presupuestal**: {final_confidence_pct}% ({confidence_label})",
            "",
            "**Auditor√≠a**: {method_count} trazas contables, {audit_count} validaciones."
          ]
        },
        "argumentative_role": "SYNTHESIS"
      },
      {
        "section_id": "S2_empirical_base",
        "title": "### Datos Financieros",
        "layer": "N1",
        "layer_name": "Base Emp√≠rica Financiera",
        "data_source": "validated_financials",
        "narrative_style": "Data-Driven",
        "template": {
          "structure": [
            "**Montos Identificados**: {fact_count} partidas.",
            "**Fuentes**: {official_sources_list}"
          ]
        },
        "argumentative_role": "EMPIRICAL_BASIS",
        "epistemological_note": {
          "include_in_output": true,
          "text": "üìã *Nota metodol√≥gica: Estas son observaciones directas del documento fuente, sin transformaci√≥n interpretativa.*"
        }
      },
      {
        "section_id": "S3_robustness_audit",
        "title": "### An√°lisis de Robustez: Validaci√≥n y Limitaciones",
        "layer": "N3",
        "layer_name": "Auditor√≠a y Robustez",
        "data_source": "audit_results",
        "narrative_style": "critical",
        "template": {
          "structure": [
            "{veto_alert}",
            "",
            "**Validaciones Ejecutadas**: {validation_count} pruebas de robustez",
            "",
            "**Contradicciones Detectadas**: {contradiction_count}",
            "{contradiction_details}",
            "",
            "**Hechos Suprimidos**: {suppressed_count} observaciones eliminadas por inconsistencia",
            "{suppression_details}",
            "",
            "**Modulaciones de Confianza**:",
            "{confidence_adjustments}",
            "",
            "**Limitaciones Metodol√≥gicas**:",
            "{limitations_list}"
          ]
        },
        "argumentative_role": "ROBUSTNESS_QUALIFIER",
        "veto_display": {
          "prominence": "high",
          "if_veto_triggered": "‚õî **VETO FINANCIERO**: {veto_reason}. Presupuesto inv√°lido para toma de decisiones.",
          "if_partial_veto": "‚ö†Ô∏è **ROBUSTEZ PARCIAL**: {partial_veto_count} hallazgos financieros invalidados.",
          "if_no_veto": "‚úÖ **VALIDACI√ìN COMPLETA**: Financiaci√≥n coherente con metas.",
          "confidence_override": 0
        },
        "epistemological_note": {
          "include_in_output": true,
          "text": "üî¨ *Nota metodol√≥gica: Esta secci√≥n aplica falsacionismo popperiano. Lo que sobrevive este escrutinio es epistemol√≥gicamente m√°s robusto.*"
        }
      },
      {
        "section_id": "S4_gaps",
        "title": "### Puntos Ciegos: Evidencia Faltante",
        "layer": "N4-META",
        "layer_name": "Meta-An√°lisis",
        "data_source": "gap_analysis",
        "narrative_style": "diagnostic",
        "template": {
          "structure": [
            "**M√©todos sin Resultados**: {empty_methods_count} de {total_methods} m√©todos no produjeron hallazgos",
            "{empty_methods_details}",
            "",
            "**Elementos Esperados no Encontrados**:",
            "{missing_elements_list}",
            "",
            "**Cobertura de Validaciones**:",
            "- Patterns ejecutados: {patterns_executed}/{patterns_total} ({pattern_coverage_pct}%)",
            "- Fuentes esperadas vs encontradas: {sources_found}/{sources_expected}",
            "",
            "**Impacto en Confianza**:",
            "{gap_impact_assessment}"
          ]
        },
        "argumentative_role": "META_TRACEABILITY",
        "epistemological_note": {
          "include_in_output": true,
          "text": "üîç *Nota metodol√≥gica: Reflexividad cr√≠tica. Reportamos lo que NO encontramos y su impacto.*"
        }
      }
    ],
    "confidence_interpretation": {
      "critical": {
        "range": [
          0,
          19
        ],
        "label": "INSUFICIENTE",
        "display": "üî¥",
        "description": "Sin respaldo presupuestal o brecha cr√≠tica >50%.",
        "action_required": "Requiere reasignaci√≥n inmediata."
      },
      "low": {
        "range": [
          20,
          49
        ],
        "label": "D√âBIL",
        "display": "üü†",
        "description": "Asignaci√≥n parcial o fuentes no oficializadas.",
        "action_required": "Revisar fuentes de financiaci√≥n."
      },
      "medium": {
        "range": [
          50,
          79
        ],
        "label": "PARCIAL",
        "display": "üü°",
        "description": "Presupuesto asignado pero con riesgos de ejecuci√≥n.",
        "action_required": "Monitoreo de ejecuci√≥n."
      },
      "high": {
        "range": [
          80,
          100
        ],
        "label": "ROBUSTO",
        "display": "üü¢",
        "description": "Financiaci√≥n plena y coherente con metas.",
        "action_required": "Viable."
      }
    },
    "template_variable_bindings": {
      "variables": {
        "verdict_statement": "synthesis.verdict",
        "final_confidence_pct": "synthesis.confidence_score * 100",
        "confidence_label": "synthesis.confidence_label",
        "method_count": "execution_stats.methods_executed",
        "audit_count": "execution_stats.validations_run",
        "fact_count": "evidence_graph.nodes(type='FACT').count",
        "official_sources_list": "evidence_graph.nodes(type='FACT').groupby('source').list",
        "veto_alert": "audit_results.veto_status",
        "veto_reason": "audit_results.primary_veto_reason",
        "contradiction_count": "audit_results.contradictions.count",
        "validation_count": "audit_results.validations_executed",
        "contradiction_details": "audit_results.contradictions.list",
        "suppressed_count": "audit_results.suppressed_facts.count",
        "suppression_details": "audit_results.suppressed_facts.list",
        "confidence_adjustments": "audit_results.confidence_modulations.list",
        "limitations_list": "audit_results.methodological_limitations.list",
        "empty_methods_count": "gap_analysis.empty_methods.count",
        "total_methods": "method_binding.method_count",
        "empty_methods_details": "gap_analysis.empty_methods.list",
        "missing_elements_list": "gap_analysis.missing_expected_elements.list",
        "patterns_executed": "gap_analysis.patterns_matched",
        "patterns_total": "question_context.patterns.count",
        "pattern_coverage_pct": "gap_analysis.pattern_coverage_percentage",
        "sources_found": "gap_analysis.official_sources_found",
        "sources_expected": "question_context.expected_elements.sources_expected",
        "gap_impact_assessment": "gap_analysis.impact_statement"
      }
    },
    "argumentative_roles": {
      "N1_roles": [
        {
          "role": "EMPIRICAL_BASIS",
          "description": "Hecho financiero observable",
          "narrative_weight": "high"
        }
      ],
      "N2_roles": [
        {
          "role": "INFERENTIAL_BRIDGE",
          "description": "C√°lculo de suficiencia derivado",
          "narrative_weight": "medium"
        }
      ],
      "N3_roles": [
        {
          "role": "ROBUSTNESS_QUALIFIER",
          "description": "Advertencia de brecha presupuestal",
          "narrative_weight": "high"
        },
        {
          "role": "FINANCIAL_CONSTRAINT",
          "description": "L√≠mites presupuestales",
          "narrative_weight": "critical",
          "triggers_veto": true
        }
      ],
      "N4_roles": [
        {
          "role": "META_TRACEABILITY",
          "description": "Calidad del proceso anal√≠tico",
          "narrative_weight": "medium"
        }
      ]
    }
  },
  "traceability": {
    "canonical_sources": {
      "questionnaire": "canonic_questionnaire_central/questionnaire_monolith.json",
      "method_inventory": "epistemological_classification_v4.json",
      "epistemological_guide": "episte_refact.md"
    },
    "prohibitions": {
      "v3_recovery": "FORBIDDEN",
      "flat_method_arrays": "FORBIDDEN",
      "untyped_outputs": "FORBIDDEN"
    },
    "generation": {
      "method": "zero_trust_manual_refactor",
      "timestamp": "2025-12-23T15:45:00Z",
      "generator_version": "1.2.0-ZERO-TRUST"
    },
    "refactoring_history": [
      {
        "from_version": "3.0.0",
        "to_version": "4.1.0-corrected",
        "date": "2025-12-23T17:40:00Z",
        "changes": [
          "Phases A/B/C",
          "Epistemological levels",
          "Typed outputs",
          "Asymmetric veto_gate",
          "veto_display",
          "argumentative_roles"
        ],
        "epistemological_framework": {
          "N1": "Empirismo positivista",
          "N2": "Formalismo contable",
          "N3": "Auditor√≠a Forense",
          "N4": "Reflexividad cr√≠tica"
        }
      }
    ]
  }
}