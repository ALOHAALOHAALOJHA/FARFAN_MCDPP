{
  "metadata": {
    "version": "1.0.0",
    "specification_source": "episte_refact.md PARTE V Section 5.2 (Blocking Propagation Rules)",
    "purpose": "Enforce Popperian asymmetry via terminal N3 verdicts",
    "created": "2024-12-31",
    "description": "N3 has veto authority - can invalidate N1/N2 findings, but N1/N2 cannot invalidate N3"
  },
  "popperian_asymmetry": {
    "description": "Asymmetric influence defined in episte_refact.md PARTE II Section 2.2",
    "principle": "PROPIEDAD CRÍTICA: Influencia ASIMÉTRICA — puede invalidar N1/N2, pero N1/N2 NO pueden invalidar N3.",
    "implications": [
      "N3 veto gates can set confidence to 0.0 (TOTAL veto)",
      "N1 extractions cannot override N3 contradictions",
      "N2 inferences cannot override N3 cycle detection",
      "Validation failures at N3 level are FATAL, not informative"
    ]
  },
  "n3_veto_conditions": {
    "TYPE_A": {
      "contradiction_detection": {
        "description": "Semantic contradictions invalidate the entire analysis",
        "veto_trigger": "any_contradiction_detected",
        "veto_action": "set_confidence_0.0",
        "severity": "FATAL",
        "pattern": "contradiction.*detect.*missing"
      }
    },
    "TYPE_B": {
      "statistical_gate": {
        "description": "Statistical validation failures invalidate Bayesian inference",
        "veto_trigger": "p_value_above_threshold OR sample_size_below_minimum",
        "veto_action": "set_confidence_0.0",
        "severity": "FATAL",
        "pattern": "statistical.*test.*fail|p.*value.*invalid|sample.*insufficient"
      }
    },
    "TYPE_C": {
      "cycle_detection": {
        "description": "Cycles in causal DAG violate acyclicity requirement",
        "veto_trigger": "any_cycle_detected",
        "veto_action": "set_confidence_0.0",
        "severity": "FATAL",
        "pattern": "cycle.*detect.*missing|acyclic.*invalid|dag.*not.*valid"
      }
    },
    "TYPE_D": {
      "fiscal_validation": {
        "description": "Fiscal sustainability violations invalidate financial analysis",
        "veto_trigger": "budget_insufficient OR fiscal_unsustainable",
        "veto_action": "set_confidence_0.0",
        "severity": "FATAL",
        "pattern": "fiscal.*invalid|budget.*gap.*exceeds.*threshold"
      }
    },
    "TYPE_E": {
      "logical_veto": {
        "description": "Logical contradictions trigger Popperian falsification",
        "veto_trigger": "any_contradiction_detected",
        "veto_action": "set_confidence_0.0",
        "severity": "FATAL",
        "pattern": "contradiction.*domin.*missing|logical.*inconsistent"
      }
    }
  },
  "fatal_violation_patterns": {
    "description": "Patterns that trigger immediate contract abortion",
    "patterns": [
      "cycle_detected",
      "fundamental_contradiction",
      "N3.*missing.*required.*pattern",
      "statistical.*gate.*failed",
      "fiscal.*sustainability.*breach",
      "dag.*not.*acyclic",
      "logical.*contradiction.*detected"
    ],
    "action": "ABORT_CONTRACT_GENERATION",
    "error_code_template": "ABORT-{base_slot}-EPISTEMIC"
  },
  "warning_violation_patterns": {
    "description": "Patterns that trigger warnings but allow execution",
    "patterns": [
      "N1.*below.*minimum",
      "N2.*below.*recommended",
      "fusion_strategy.*suboptimal",
      "layer_ratio.*outside.*range"
    ],
    "action": "LOG_WARNING_CONTINUE",
    "remediation": "SUGGEST_REGENERATION"
  },
  "validation_to_execution_mapping": {
    "description": "How validation results map to execution decisions",
    "terminal_verdict_mode": {
      "enabled": true,
      "description": "When enabled, N3 validation failures prevent contract execution",
      "implementation": """
      def should_execute_contract(contract, validation_results):
          '''
          Per episte_refact.md PARTE V Section 5.2
          N3 validation is authoritative, not informative
          '''
          if not TERMINAL_VERDICT_MODE:
              return True  # Legacy behavior

          # Check for fatal violations
          n3_violations = validation_results.get('N3', [])
          for violation in n3_violations:
              if is_fatal_pattern(violation):
                  logger.critical(f"N3 TERMINAL VERDICT: {violation}")
                  return False  # ABORT

          # Check for mandatory pattern violations
          missing_patterns = validation_results.get('missing_mandatory_patterns', [])
          if missing_patterns.get('N3', []):
              logger.critical(f"N3 MANDATORY PATTERN VIOLATION: {missing_patterns['N3']}")
              return False  # ABORT

          return True  # All N3 checks passed
      """
    }
  },
  "regeneration_triggers": {
    "description": "Conditions that trigger contract regeneration",
    "triggers": [
      {
        "condition": "N3 mandatory pattern missing",
        "severity": "FATAL",
        "action": "regenerate_with_n3_constraint",
        "max_attempts": 3
      },
      {
        "condition": "N3 veto condition violated",
        "severity": "FATAL",
        "action": "regenerate_with_veto_enforcement",
        "max_attempts": 3
      },
      {
        "condition": "Layer ratio outside expected range",
        "severity": "WARNING",
        "action": "suggest_regeneration",
        "max_attempts": 1
      }
    ]
  },
  "enforcement_points": {
    "description": "Where in the pipeline N3 authority is enforced",
    "points": [
      {
        "location": "contract_generation",
        "check": "validate_epistemic_structure",
        "on_failure": "regenerate_or_abort"
      },
      {
        "location": "method_selection",
        "check": "enforce_mandatory_n3_patterns",
        "on_failure": "force_include_n3_methods"
      },
      {
        "location": "pre_execution",
        "check": "terminal_verdict_check",
        "on_failure": "abort_execution"
      },
      {
        "location": "post_execution",
        "check": "n3_veto_application",
        "on_failure": "zero_confidence_result"
      }
    ]
  },
  "example_fatal_scenarios": {
    "TYPE_A_semantic_missing_contradiction_detection": {
      "validation_output": "TYPE_A N3: Missing required pattern from ['contradiction_detection']",
      "n3_verdict": "FATAL",
      "action": "REGENERATE with contradiction_detection forced in",
      "rationale": "Semantic analysis without contradiction detection is epistemically invalid"
    },
    "TYPE_C_dag_has_cycle": {
      "validation_output": "cycles_found: [['node_a', 'node_b', 'node_a']]",
      "n3_verdict": "FATAL - confidence = 0.0",
      "action": "ABORT - Causal DAG with cycles is not a valid DAG",
      "rationale": "Causal inference on cyclic graphs is undefined"
    },
    "TYPE_E_contradiction_detected": {
      "validation_output": "contradiction_dominator: has_contradiction=True",
      "n3_verdict": "FATAL - Popperian falsification",
      "action": "ABORT - ONE contradiction refutes the hypothesis",
      "rationale": "Logical contracts require absolute consistency"
    }
  }
}
