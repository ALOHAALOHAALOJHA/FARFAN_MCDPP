# Phase 8 Comprehensive Guide - Architecture Diagram

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    PHASE 8 COMPREHENSIVE GUIDE ARCHITECTURE                      â•‘
â•‘                   Transforming FARFAN Diagnostics to PDM                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              INPUT LAYER                                         â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚  FARFAN Diagnostic â”‚         â”‚ Capacity Evidence    â”‚                        â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚                        â”‚
â”‚  â”‚  â€¢ 300 Questions   â”‚         â”‚ â€¢ 9 Dimensions       â”‚                        â”‚
â”‚  â”‚  â€¢ 10 Policy Areas â”‚         â”‚ â€¢ Evidence Lists     â”‚                        â”‚
â”‚  â”‚  â€¢ 6 Dimensions    â”‚         â”‚ â€¢ Municipal Category â”‚                        â”‚
â”‚  â”‚  â€¢ Scores/Evidence â”‚         â”‚                      â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚           â”‚                              â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                              â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   TRANSFORMATION PIPELINE (8 STEPS)                              â”‚
â”‚                   phase8_32_00_transformation_pipeline.py                        â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚ STEP 1: Data Synthesis & Problem Tree Construction                          â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚  â”‚ â€¢ Extract FARFAN evidence                                                    â”‚
â”‚  â”‚ â€¢ Construct: Effects â†’ Central Problem â†’ Causes                             â”‚
â”‚  â”‚ â€¢ Validate data completeness                                                 â”‚
â”‚  â”‚ Output: ProblemTree                                                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â–¼                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚ STEP 2: Objective Formulation (DNP Rules)                                   â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚
â”‚  â”‚ Module: phase8_29_00_value_chain_integration.py                             â”‚
â”‚  â”‚ â€¢ Invert central problem â†’ Objetivo General                                 â”‚
â”‚  â”‚ â€¢ Convert causes â†’ Objetivos EspecÃ­ficos                                    â”‚
â”‚  â”‚ â€¢ Validate: [VERBO INFINITIVO] + [OBJETO] + [DESCRIPTIVOS]                 â”‚
â”‚  â”‚ â€¢ Avoid: solution mechanisms, effects, metas                                â”‚
â”‚  â”‚ Output: ObjetivoGeneral + list[ObjetivoEspecifico]                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â–¼                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚ STEP 3: Capacity Assessment (9 Dimensions)                                  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚
â”‚  â”‚ Module: phase8_27_00_policy_capacity_framework.py                           â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚    â”‚  3Ã—3 Capacity Matrix (Wu-Ramesh-Howlett)              â”‚               â”‚
â”‚  â”‚    â”‚                                                        â”‚               â”‚
â”‚  â”‚    â”‚                Analytical  Operational  Political     â”‚               â”‚
â”‚  â”‚    â”‚  Individual        [1]         [2]         [3]        â”‚               â”‚
â”‚  â”‚    â”‚  Organizational    [4]         [5]         [6]        â”‚               â”‚
â”‚  â”‚    â”‚  Systemic          [7]         [8]         [9]        â”‚               â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”‚ â€¢ Assess each dimension (LOW/MEDIUM/HIGH)                                   â”‚
â”‚  â”‚ â€¢ Identify binding constraints                                              â”‚
â”‚  â”‚ â€¢ Generate sequencing recommendations                                       â”‚
â”‚  â”‚ Output: ComprehensiveCapacityProfile                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â–¼                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚ STEP 4: Instrument Selection (Howlett's NATO)                               â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚  â”‚ Module: phase8_28_00_howlett_instruments.py                                 â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚    â”‚  Policy Instruments (NATO Framework)               â”‚                  â”‚
â”‚  â”‚    â”‚                                                     â”‚                  â”‚
â”‚  â”‚    â”‚  Information (4)    Authority (4)                  â”‚                  â”‚
â”‚  â”‚    â”‚  â€¢ Campaigns        â€¢ Regulations                  â”‚                  â”‚
â”‚  â”‚    â”‚  â€¢ Training         â€¢ Permits                      â”‚                  â”‚
â”‚  â”‚    â”‚  â€¢ Labeling         â€¢ Self-regulation              â”‚                  â”‚
â”‚  â”‚    â”‚  â€¢ Exhortation      â€¢ Standards                    â”‚                  â”‚
â”‚  â”‚    â”‚                                                     â”‚                  â”‚
â”‚  â”‚    â”‚  Treasure (5)       Organization (2)               â”‚                  â”‚
â”‚  â”‚    â”‚  â€¢ Subsidies        â€¢ Direct Provision             â”‚                  â”‚
â”‚  â”‚    â”‚  â€¢ Vouchers         â€¢ Co-production                â”‚                  â”‚
â”‚  â”‚    â”‚  â€¢ Tax breaks       â€¢ Advisory Committees          â”‚                  â”‚
â”‚  â”‚    â”‚  â€¢ User charges     â€¢ Public Enterprises           â”‚                  â”‚
â”‚  â”‚    â”‚  â€¢ Procurement      â€¢ Reorganization               â”‚                  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”‚ â€¢ Match instruments to capacity profile                                     â”‚
â”‚  â”‚ â€¢ Select primary + supporting + enabling                                    â”‚
â”‚  â”‚ â€¢ Determine sequencing (Quick Wins â†’ Capacity â†’ Substantive)               â”‚
â”‚  â”‚ Output: dict[Objective, InstrumentMix]                                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â–¼                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚ STEP 5: Product & Activity Specification (Value Chain)                      â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”‚
â”‚  â”‚ Module: phase8_29_00_value_chain_integration.py                             â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”‚ â€¢ Specify Productos (goods/services with quantifiable units)                â”‚
â”‚  â”‚ â€¢ Identify Actividades (minimum 2 per product)                              â”‚
â”‚  â”‚ â€¢ Validate DNP rules:                                                       â”‚
â”‚  â”‚   - No condition words in product names                                     â”‚
â”‚  â”‚   - Coherent units of measure                                               â”‚
â”‚  â”‚   - Specific action verbs in activities                                     â”‚
â”‚  â”‚ â€¢ Build complete value chain                                                â”‚
â”‚  â”‚ Output: ValueChainStructure (validated)                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â–¼                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚ STEP 6: Resource Allocation & Timeline (Colombian Legal Framework)          â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚
â”‚  â”‚ Module: phase8_30_00_colombian_legal_framework.py                           â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚    â”‚  Municipal Categories & SGP Allocation               â”‚                â”‚
â”‚  â”‚    â”‚                                                       â”‚                â”‚
â”‚  â”‚    â”‚  Category    Population    SGP Dependency            â”‚                â”‚
â”‚  â”‚    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚                â”‚
â”‚  â”‚    â”‚  Special     >500,000      Low (own revenue)         â”‚                â”‚
â”‚  â”‚    â”‚  1           100-500k      Low-Medium                â”‚                â”‚
â”‚  â”‚    â”‚  2           50-100k       Medium                    â”‚                â”‚
â”‚  â”‚    â”‚  3           30-50k        Medium-High               â”‚                â”‚
â”‚  â”‚    â”‚  4           20-30k        High                      â”‚                â”‚
â”‚  â”‚    â”‚  5           10-20k        Very High                 â”‚                â”‚
â”‚  â”‚    â”‚  6           <10k          Complete                  â”‚                â”‚
â”‚  â”‚    â”‚                                                       â”‚                â”‚
â”‚  â”‚    â”‚  SGP: Education 58.5% | Health 24.5%                â”‚                â”‚
â”‚  â”‚    â”‚       General 11.6% (42% discretionary for 4-6)     â”‚                â”‚
â”‚  â”‚    â”‚       Water 5.4%                                     â”‚                â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”‚ â€¢ Calculate budget allocation (SGP + own-source)                            â”‚
â”‚  â”‚ â€¢ Identify financing sources by instrument                                  â”‚
â”‚  â”‚ â€¢ Validate legal obligations for policy area                                â”‚
â”‚  â”‚ â€¢ Map PDM formulation timeline (Jan-May)                                    â”‚
â”‚  â”‚ Output: PDMCompliance                                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â–¼                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚ STEP 7: Narrative Generation (Lenguaje Claro)                               â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚  â”‚ Module: phase8_31_00_narrative_generation.py                                â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚    â”‚  Carver Principles (5 Checks)                           â”‚             â”‚
â”‚  â”‚    â”‚                                                          â”‚             â”‚
â”‚  â”‚    â”‚  1. Active Voice     ("AlcaldÃ­a construirÃ¡")            â”‚             â”‚
â”‚  â”‚    â”‚  2. Concrete Nouns   ("10 aulas" not "infraestructura") â”‚             â”‚
â”‚  â”‚    â”‚  3. Specific Verbs   ("construir" not "fortalecer")     â”‚             â”‚
â”‚  â”‚    â”‚  4. Sentence Length  (<25 words)                        â”‚             â”‚
â”‚  â”‚    â”‚  5. Familiar Vocab   (avoid jargon)                     â”‚             â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚  â”‚                                                                              â”‚
â”‚  â”‚ â€¢ Generate 6-section prose:                                                 â”‚
â”‚  â”‚   1. Diagnosis Context (FARFAN findings)                                    â”‚
â”‚  â”‚   2. Intervention Description (instruments + activities)                    â”‚
â”‚  â”‚   3. Timeline Specification (month-by-month)                                â”‚
â”‚  â”‚   4. Budget Details (sources, amounts, responsible)                         â”‚
â”‚  â”‚   5. Verification Mechanisms (indicators, frequency)                        â”‚
â”‚  â”‚   6. Sustainability Approach (long-term)                                    â”‚
â”‚  â”‚ â€¢ Convert bullet points to flowing prose                                    â”‚
â”‚  â”‚ â€¢ Validate Carver compliance (score 0-100)                                  â”‚
â”‚  â”‚ Output: ProseRecommendation                                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â–¼                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚ STEP 8: Quality Verification                                                â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                               â”‚
â”‚  â”‚ â€¢ Validate value chain (DNP methodology)                                    â”‚
â”‚  â”‚ â€¢ Validate legal compliance                                                 â”‚
â”‚  â”‚ â€¢ Validate Carver principles                                                â”‚
â”‚  â”‚ â€¢ Calculate quality score (0-100):                                          â”‚
â”‚  â”‚   - 40%: Carver compliance                                                  â”‚
â”‚  â”‚   - 30%: Value chain validity                                               â”‚
â”‚  â”‚   - 20%: Legal compliance                                                   â”‚
â”‚  â”‚   - 10%: Financing feasibility                                              â”‚
â”‚  â”‚ Output: Quality score + validation report                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              OUTPUT LAYER                                        â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PipelineResult (Complete Transformation Output)                          â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚  â”‚
â”‚  â”‚                                                                            â”‚  â”‚
â”‚  â”‚  ðŸ“Š Capacity Profile                                                       â”‚  â”‚
â”‚  â”‚     â€¢ 9 dimension assessments                                             â”‚  â”‚
â”‚  â”‚     â€¢ Binding constraints identified                                      â”‚  â”‚
â”‚  â”‚     â€¢ Implementation readiness                                            â”‚  â”‚
â”‚  â”‚     â€¢ Sequencing recommendations                                          â”‚  â”‚
â”‚  â”‚                                                                            â”‚  â”‚
â”‚  â”‚  â›“ï¸  Value Chain Structure                                                 â”‚  â”‚
â”‚  â”‚     â€¢ Problem tree                                                        â”‚  â”‚
â”‚  â”‚     â€¢ Objetivo General + EspecÃ­ficos                                      â”‚  â”‚
â”‚  â”‚     â€¢ Productos (with quantifiable units)                                 â”‚  â”‚
â”‚  â”‚     â€¢ Actividades (minimum 2 per product)                                 â”‚  â”‚
â”‚  â”‚     â€¢ DNP validation: âœ“ Valid                                             â”‚  â”‚
â”‚  â”‚                                                                            â”‚  â”‚
â”‚  â”‚  ðŸ› ï¸  Instrument Mixes                                                      â”‚  â”‚
â”‚  â”‚     â€¢ Primary + Supporting + Enabling                                     â”‚  â”‚
â”‚  â”‚     â€¢ Capacity-matched                                                    â”‚  â”‚
â”‚  â”‚     â€¢ Sequencing phase                                                    â”‚  â”‚
â”‚  â”‚     â€¢ Budget estimates                                                    â”‚  â”‚
â”‚  â”‚                                                                            â”‚  â”‚
â”‚  â”‚  âš–ï¸  PDM Compliance                                                        â”‚  â”‚
â”‚  â”‚     â€¢ Legal obligations validated                                         â”‚  â”‚
â”‚  â”‚     â€¢ SGP allocation calculated                                           â”‚  â”‚
â”‚  â”‚     â€¢ Financing sources identified                                        â”‚  â”‚
â”‚  â”‚     â€¢ Timeline mapped (Jan-May)                                           â”‚  â”‚
â”‚  â”‚                                                                            â”‚  â”‚
â”‚  â”‚  âœï¸  Prose Recommendation (Lenguaje Claro)                                â”‚  â”‚
â”‚  â”‚     â€¢ Full text (6 sections)                                              â”‚  â”‚
â”‚  â”‚     â€¢ Carver compliance: 85/100 âœ“                                         â”‚  â”‚
â”‚  â”‚     â€¢ Word count, sentence length                                         â”‚  â”‚
â”‚  â”‚     â€¢ PDM-ready format                                                    â”‚  â”‚
â”‚  â”‚                                                                            â”‚  â”‚
â”‚  â”‚  âœ“ Quality Score: 87.5/100                                                â”‚  â”‚
â”‚  â”‚  âœ“ Success: True                                                          â”‚  â”‚
â”‚  â”‚  âœ“ Traceability: FARFAN Q001-Q005 â†’ Evidence â†’ Recommendation            â”‚  â”‚
â”‚  â”‚                                                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                  â”‚
â”‚  Ready for PDM Integration âœ“                                                    â”‚
â”‚  Colombian Legal Compliance âœ“                                                   â”‚
â”‚  Capacity-Calibrated âœ“                                                          â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           MODULE DEPENDENCIES                                    â”‚
â”‚                                                                                  â”‚
â”‚  phase8_32 (Pipeline)                                                           â”‚
â”‚       â”œâ”€â”€ phase8_27 (Capacity)                                                  â”‚
â”‚       â”œâ”€â”€ phase8_28 (Instruments) â”€â”€â”                                          â”‚
â”‚       â”‚                              â”œâ”€â”€ phase8_27 (Capacity)                   â”‚
â”‚       â”œâ”€â”€ phase8_29 (Value Chain) â”€â”€â”€â”¤                                         â”‚
â”‚       â”‚                              â””â”€â”€ phase8_28 (Instruments)                â”‚
â”‚       â”œâ”€â”€ phase8_30 (Legal) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚       â””â”€â”€ phase8_31 (Narrative) â”€â”€â”€â”€â”€â”€â”¬â”€â”€ phase8_29 (Value Chain)              â”‚
â”‚                                        â”œâ”€â”€ phase8_28 (Instruments)              â”‚
â”‚                                        â”œâ”€â”€ phase8_27 (Capacity)                 â”‚
â”‚                                        â””â”€â”€ phase8_30 (Legal)                    â”‚
â”‚                                                                                  â”‚
â”‚  All modules independent, well-tested, production-ready                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LEGEND:
â•â•â•â•â•â•â•  Major component boundary
â”€â”€â”€â”€â”€â”€â”€  Sub-component or step
â–¼        Data flow direction
â”Œâ”€â”€â”€â”€â”€â”  Module or process box
â”‚     â”‚  Container
```
