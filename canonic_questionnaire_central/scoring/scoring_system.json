{
  "_comment": "Canonical Scoring System Configuration",
  "_comment_aligned_with": "Phase Three primitives (src/farfan_pipeline/phases/Phase_three/primitives/)",
  "_version": "2.0.0",
  "_generated_at": "2026-01-01T00:00:00Z",

  "micro_levels": [
    {
      "level": "EXCELENTE",
      "color": "green",
      "min_score": 0.85,
      "_aligned_with": "Phase Three QualityLevel.EXCELENTE"
    },
    {
      "level": "BUENO",
      "color": "blue",
      "min_score": 0.70,
      "_aligned_with": "Phase Three QualityLevel.GOOD (Spanish canonical)"
    },
    {
      "level": "ACEPTABLE",
      "color": "yellow",
      "min_score": 0.55,
      "_aligned_with": "Phase Three QualityLevel.ADEQUATE (Spanish canonical)"
    },
    {
      "level": "INSUFICIENTE",
      "color": "red",
      "min_score": 0.0,
      "_aligned_with": "Phase Three QualityLevel.POOR (Spanish canonical)"
    }
  ],

  "modalities": {
    "MESO_INTEGRATION": {
      "description": "Cluster-level integration scoring (evaluates policy coherence across policy areas within a cluster)",
      "max_score": 3,
      "aggregation": "weighted_average_with_coherence_bonus",
      "threshold": 0.65,
      "use_case": "meso questions evaluating cross-policy area integration",
      "weights": {
        "policy_area_coverage": 0.4,
        "cross_references": 0.3,
        "narrative_coherence": 0.3
      },
      "coherence_bonus": {
        "enabled": true,
        "max_bonus": 0.15,
        "criteria": "Explicit cross-references between 2+ policy areas in cluster"
      },
      "_aligned_with": "Phase Three cluster aggregation logic"
    },
    "MACRO_HOLISTIC": {
      "description": "Macro-level holistic assessment (evaluates overall plan coherence across all dimensions and clusters)",
      "max_score": 3,
      "aggregation": "holistic_weighted_synthesis",
      "threshold": 0.70,
      "use_case": "macro question evaluating entire plan vision and integration",
      "weights": {
        "cluster_integration": 0.35,
        "dimension_completeness": 0.25,
        "long_term_vision": 0.20,
        "narrative_coherence": 0.20
      },
      "holistic_criteria": {
        "minimum_cluster_scores": 4,
        "minimum_dimension_scores": 5,
        "cross_cluster_linkages": 3,
        "strategic_vision_explicit": true
      },
      "_aligned_with": "Phase Three macro aggregation logic"
    },
    "TYPE_A": {
      "description": "Quantitative indicators (high threshold, precise)",
      "max_score": 3,
      "aggregation": "presence_threshold",
      "threshold": 0.7,
      "use_case": "numeric indicators, budgets, goals",
      "_aligned_with": "Phase Three score_type_a()"
    },
    "TYPE_B": {
      "description": "Qualitative descriptors (medium threshold, patterns)",
      "max_score": 3,
      "aggregation": "binary_sum",
      "threshold": 0.65,
      "use_case": "institutional actors, policy instruments",
      "_aligned_with": "Phase Three score_type_b()"
    },
    "TYPE_C": {
      "description": "Mixed evidence (balanced weights)",
      "max_score": 3,
      "aggregation": "presence_threshold",
      "threshold": 0.5,
      "use_case": "mixed quantitative/qualitative questions",
      "_aligned_with": "Phase Three score_type_c()"
    },
    "TYPE_D": {
      "description": "Temporal series (sequence-aware)",
      "max_score": 3,
      "aggregation": "weighted_sum",
      "threshold": 0.65,
      "weights": [0.4, 0.3, 0.3],
      "use_case": "time series, historical trends",
      "_aligned_with": "Phase Three score_type_d()"
    },
    "TYPE_E": {
      "description": "Territorial coverage (spatial)",
      "max_score": 3,
      "aggregation": "binary_presence",
      "threshold": 0.65,
      "use_case": "geographic distribution, regional policies",
      "_aligned_with": "Phase Three score_type_e()"
    },
    "TYPE_F": {
      "description": "Institutional actors (relational)",
      "max_score": 3,
      "aggregation": "normalized_continuous",
      "threshold": 0.65,
      "normalization": "minmax",
      "use_case": "actor networks, governance structures",
      "_aligned_with": "Phase Three score_type_f()"
    }
  },

  "modality_definitions": {
    "MESO_INTEGRATION": {
      "aggregation": "weighted_average_with_coherence_bonus",
      "description": "Cluster integration score = (weighted avg of policy area scores) + coherence bonus",
      "failure_code": "F-MESO-MIN",
      "threshold": 0.65,
      "weights": {
        "policy_area_coverage": 0.4,
        "cross_references": 0.3,
        "narrative_coherence": 0.3
      },
      "formula": "SCORE = (0.4 * coverage + 0.3 * cross_ref + 0.3 * coherence) + bonus",
      "bonus_criteria": "bonus = 0.15 if cross_references >= 2, else 0"
    },
    "MACRO_HOLISTIC": {
      "aggregation": "holistic_weighted_synthesis",
      "description": "Macro holistic score = weighted synthesis of cluster, dimension, vision, and narrative scores",
      "failure_code": "F-MACRO-MIN",
      "threshold": 0.70,
      "weights": {
        "cluster_integration": 0.35,
        "dimension_completeness": 0.25,
        "long_term_vision": 0.20,
        "narrative_coherence": 0.20
      },
      "formula": "SCORE = 0.35 * cluster_avg + 0.25 * dim_complete + 0.20 * vision + 0.20 * narrative",
      "minimum_requirements": {
        "min_clusters_passing": 4,
        "min_dimensions_passing": 5,
        "min_cross_linkages": 3
      }
    },
    "TYPE_A": {
      "aggregation": "presence_threshold",
      "description": "Count 4 elements and scale to 0-3",
      "failure_code": "F-A-MIN",
      "threshold": 0.7,
      "weights": [0.5, 0.3, 0.2]
    },
    "TYPE_B": {
      "aggregation": "binary_sum",
      "description": "Count up to 3 elements, each worth 1 point",
      "failure_code": "F-B-MIN",
      "max_score": 3,
      "weights": [0.4, 0.3, 0.3]
    },
    "TYPE_C": {
      "aggregation": "presence_threshold",
      "description": "Count 2 elements and scale to 0-3",
      "failure_code": "F-C-MIN",
      "threshold": 0.5,
      "weights": [0.33, 0.34, 0.33]
    },
    "TYPE_D": {
      "aggregation": "weighted_sum",
      "description": "Count 3 elements, weighted",
      "failure_code": "F-D-MIN",
      "threshold": 0.65,
      "weights": [0.4, 0.3, 0.3]
    },
    "TYPE_E": {
      "aggregation": "binary_presence",
      "description": "Boolean presence check",
      "failure_code": "F-E-MIN",
      "threshold": 0.65
    },
    "TYPE_F": {
      "aggregation": "normalized_continuous",
      "description": "Continuous scale",
      "failure_code": "F-F-MIN",
      "threshold": 0.65,
      "normalization": "minmax"
    }
  },

  "quality_level_mapping": {
    "completeness_to_quality": {
      "complete": "EXCELENTE",
      "partial": "ACEPTABLE",
      "insufficient": "INSUFICIENTE",
      "not_applicable": "NO_APLICABLE",
      "_aligned_with": "Phase Three map_completeness_to_quality()"
    },
    "score_to_quality": {
      "excellent_min": 0.85,
      "good_min": 0.70,
      "adequate_min": 0.55,
      "_aligned_with": "Phase Three determine_quality_level()"
    }
  },

  "invariants": {
    "INV-SC-001": "All scores must be in range [0.0, 1.0]",
    "INV-SC-002": "Quality level must be deterministic from score",
    "INV-SC-003": "Scoring metadata must include modality and threshold",
    "INV-SC-004": "Normalized scores must be in range [0, 100]"
  },

  "pdet_enrichment": {
    "_description": "PDET municipality context enrichment for scoring",
    "_version": "1.0.0",
    "_validated_through": "Four-gate validation framework",
    
    "enabled": true,
    "strict_mode": true,
    "enable_territorial_adjustment": true,
    
    "validation_gates": {
      "gate_1_scope": {
        "description": "Consumer scope validity - Scoring system authorized for PDET data",
        "required_signal_types": ["ENRICHMENT_DATA"],
        "scope_level": "EVIDENCE_COLLECTION"
      },
      "gate_2_value_add": {
        "description": "Value contribution - PDET context improves territorial scoring accuracy",
        "min_value_threshold": 0.10,
        "estimated_value_add": 0.25
      },
      "gate_3_capability": {
        "description": "Consumer capability - Scoring system has semantic processing",
        "required_capabilities": ["SEMANTIC_PROCESSING", "TABLE_PARSING"],
        "recommended_capabilities": ["GRAPH_CONSTRUCTION"]
      },
      "gate_4_channel": {
        "description": "Channel authenticity - PDET enrichment flow is explicit and traceable",
        "flow_id": "PDET_MUNICIPALITY_ENRICHMENT",
        "documentation_path": "canonic_questionnaire_central/colombia_context/README_PDET_ENRICHMENT.md"
      }
    },
    
    "territorial_adjustments": {
      "_description": "Threshold adjustments based on PDET territorial coverage",
      "coverage_high_bonus": 0.05,
      "coverage_medium_bonus": 0.03,
      "pillar_relevance_bonus_per_pillar": 0.03,
      "pillar_relevance_max_bonus": 0.09,
      "territorial_modality_bonus": 0.02,
      "max_total_adjustment": 0.16,
      "min_threshold_floor": 0.4
    },
    
    "policy_area_to_pdet_subregions": {
      "PA01_Gender": ["SR04", "SR05", "SR08"],
      "PA02_Violence_Security": ["SR01", "SR02", "SR03", "SR04", "SR05", "SR06", "SR07", "SR08"],
      "PA03_Environment": ["SR03", "SR05", "SR06", "SR07"],
      "PA04_Economic_Development": ["SR02", "SR03", "SR04", "SR06", "SR07", "SR08"],
      "PA05_Victims_Restitution": ["SR01", "SR05", "SR08"],
      "PA06_Children_Youth": ["SR04", "SR05", "SR06"],
      "PA07_Peace_Building": ["SR01", "SR02", "SR03", "SR04", "SR07"],
      "PA08_Human_Rights": ["SR08"],
      "PA09_Justice": ["SR01"],
      "PA10_International": ["SR02", "SR04"]
    },
    
    "pdet_pillars_to_dimensions": {
      "pillar_1_land_formalization": "Structural",
      "pillar_2_infrastructure": "Instrumental",
      "pillar_3_rural_health": "Substantive",
      "pillar_4_education": "Procedural",
      "pillar_5_housing_water": "Substantive",
      "pillar_6_economic_reactivation": "Instrumental",
      "pillar_7_food_security": "Substantive",
      "pillar_8_reconciliation": "Symbolic"
    },
    
    "enrichment_metadata_schema": {
      "municipalities_count": "Number of relevant PDET municipalities",
      "subregions_count": "Number of relevant PDET subregions",
      "territorial_coverage": "Coverage ratio [0.0-1.0]",
      "relevant_pillars": "List of applicable PDET pillars",
      "territorial_adjustment": "Applied threshold adjustment",
      "gate_validation_status": "Status of four validation gates",
      "enrichment_timestamp": "ISO timestamp of enrichment"
    }
  }
}
