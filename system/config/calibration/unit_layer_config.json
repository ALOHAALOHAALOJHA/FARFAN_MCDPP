{
  "_metadata": {
    "version": "1.0.0",
    "description": "Unit Layer (@u) Configuration - S/M/I/P Components",
    "last_updated": "2024-12-07",
    "notes": "Complete configuration for PDT quality evaluation with hard gates and anti-gaming measures"
  },
  "component_weights": {
    "description": "Weights for S/M/I/P components (must sum to 1.0)",
    "w_S": 0.25,
    "w_M": 0.25,
    "w_I": 0.25,
    "w_P": 0.25
  },
  "aggregation": {
    "description": "Aggregation method for combining S/M/I/P scores",
    "aggregation_type": "geometric_mean",
    "alternatives": {
      "geometric_mean": "(S·M·I·P)^(1/4) - Recommended, penalizes low outliers",
      "harmonic_mean": "4/(1/S + 1/M + 1/I + 1/P) - More severe penalty for low scores",
      "weighted_average": "w_S·S + w_M·M + w_I·I + w_P·P - Linear combination"
    }
  },
  "hard_gates": {
    "description": "Hard gates that trigger immediate U=0.0 failure",
    "require_ppi_presence": true,
    "require_indicator_matrix": true,
    "min_structural_compliance": 0.5,
    "i_struct_hard_gate": 0.7,
    "p_struct_hard_gate": 0.7
  },
  "anti_gaming_thresholds": {
    "description": "Thresholds to detect and penalize gaming attempts",
    "max_placeholder_ratio": 0.10,
    "min_unique_values_ratio": 0.5,
    "min_number_density": 0.02,
    "gaming_penalty_cap": 0.3
  },
  "S_structural_compliance": {
    "description": "S = 0.5·B_cov + 0.25·H + 0.25·O",
    "formula": "Block coverage + Hierarchy score + Order penalty",
    "w_block_coverage": 0.5,
    "w_hierarchy": 0.25,
    "w_order": 0.25,
    "min_block_tokens": 100,
    "min_block_numbers": 3,
    "hierarchy_excellent_threshold": 0.9,
    "hierarchy_acceptable_threshold": 0.6,
    "mandatory_blocks": [
      "Diagnóstico",
      "Parte Estratégica",
      "PPI",
      "Seguimiento"
    ]
  },
  "M_mandatory_sections": {
    "description": "M = weighted average of section scores (critical sections have 2.0x weight)",
    "critical_sections_weight": 2.0,
    "sections": {
      "Diagnóstico": {
        "critical": true,
        "min_tokens": 800,
        "min_keywords": 3,
        "min_numbers": 10,
        "min_sources": 2,
        "keywords": ["brecha", "DANE", "línea base", "indicador", "problemática"]
      },
      "Parte Estratégica": {
        "critical": true,
        "min_tokens": 600,
        "min_keywords": 2,
        "min_numbers": 5,
        "keywords": ["visión", "misión", "objetivo", "estrategia", "lineamiento"]
      },
      "PPI": {
        "critical": true,
        "min_tokens": 400,
        "min_keywords": 2,
        "min_numbers": 8,
        "keywords": ["proyecto", "inversión", "presupuesto", "costo"]
      },
      "Seguimiento": {
        "critical": false,
        "min_tokens": 300,
        "min_keywords": 2,
        "min_numbers": 3,
        "keywords": ["seguimiento", "monitoreo", "evaluación", "indicador"]
      },
      "Marco Normativo": {
        "critical": false,
        "min_tokens": 200,
        "min_keywords": 1,
        "keywords": ["ley", "decreto", "normativa", "acuerdo"]
      }
    }
  },
  "I_indicator_quality": {
    "description": "I = 0.4·I_struct + 0.3·I_link + 0.3·I_logic",
    "formula": "Structural completeness + Linkage + Logic validation",
    "w_i_struct": 0.4,
    "w_i_link": 0.3,
    "w_i_logic": 0.3,
    "i_struct": {
      "description": "Weighted field completeness with placeholder penalties",
      "critical_fields_weight": 2.0,
      "placeholder_penalty_multiplier": 3.0,
      "critical_fields": [
        "Tipo",
        "Línea Estratégica",
        "Programa",
        "Línea Base",
        "Meta Cuatrienio",
        "Fuente",
        "Unidad Medida"
      ],
      "optional_fields": [
        "Año LB",
        "Código MGA"
      ],
      "placeholders": ["S/D", "N/A", "TBD", ""]
    },
    "i_link": {
      "description": "Fuzzy match Programa to Línea + MGA code validation",
      "fuzzy_match_threshold": 0.85,
      "mga_code_format": "7-digit numeric",
      "weights": {
        "programa_linea_match": 0.6,
        "mga_validation": 0.4
      }
    },
    "i_logic": {
      "description": "Temporal validity check",
      "formula": "1.0 - (violations / total_rows)",
      "valid_lb_year_min": 2015,
      "valid_lb_year_max": 2024
    }
  },
  "P_ppi_completeness": {
    "description": "P = 0.2·P_presence + 0.4·P_struct + 0.4·P_consistency",
    "formula": "Presence + Structural completeness + Consistency validation",
    "w_p_presence": 0.2,
    "w_p_structure": 0.4,
    "w_p_consistency": 0.4,
    "p_presence": {
      "description": "1.0 if PPI matrix exists, 0.0 otherwise"
    },
    "p_struct": {
      "description": "Completeness score based on non-zero rows",
      "nonzero_row_threshold": 0.80,
      "required_fields": [
        "Línea Estratégica",
        "Programa",
        "Costo Total",
        "2024",
        "2025",
        "2026",
        "2027",
        "SGP",
        "SGR",
        "Propios",
        "Otras"
      ]
    },
    "p_consistency": {
      "description": "Accounting closure validation",
      "formula": "1.0 - (violations / (rows × checks))",
      "accounting_tolerance": 0.01,
      "trazabilidad_threshold": 0.80,
      "checks": [
        "temporal_sum = 2024 + 2025 + 2026 + 2027 = Costo Total",
        "source_sum = SGP + SGR + Propios + Otras = Costo Total"
      ]
    }
  },
  "quality_levels": {
    "description": "Final quality classification based on U_final score",
    "sobresaliente": {
      "threshold": 0.85,
      "description": "Outstanding PDT quality - all components excellent"
    },
    "robusto": {
      "threshold": 0.7,
      "description": "Robust PDT quality - strong performance across components"
    },
    "mínimo": {
      "threshold": 0.5,
      "description": "Minimum acceptable PDT quality - meets basic requirements"
    },
    "insuficiente": {
      "threshold": 0.0,
      "description": "Insufficient PDT quality - fails to meet standards"
    }
  }
}
